<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="5.实战内容【动态系统】终于到了本部分结尾，从开始写这部分内容到现在花了好久时间，几乎每天都不做别的事情，不知道写的内容有没有问题，有没有通俗易懂，不过反正我也是小白，有问题还需要请读者反馈,谢谢！ 实战内容来做什么呢？我们就来实现一个简单的朋友圈的功能。 当然对于这部分内容，我们仅仅实现发动态，改动态，删动态，查看动态这四个功能，其他的点赞，评论的功能其实也可以做，但是跨度太大，怕一时不能接受，">
<meta property="og:type" content="website">
<meta property="og:title" content="苏·凌">
<meta property="og:url" content="https://surine.cn/SpringBoot/2.快速入门/5.实战内容.html">
<meta property="og:site_name" content="苏·凌">
<meta property="og:description" content="5.实战内容【动态系统】终于到了本部分结尾，从开始写这部分内容到现在花了好久时间，几乎每天都不做别的事情，不知道写的内容有没有问题，有没有通俗易懂，不过反正我也是小白，有问题还需要请读者反馈,谢谢！ 实战内容来做什么呢？我们就来实现一个简单的朋友圈的功能。 当然对于这部分内容，我们仅仅实现发动态，改动态，删动态，查看动态这四个功能，其他的点赞，评论的功能其实也可以做，但是跨度太大，怕一时不能接受，">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547949436448.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547978763297.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547978894632.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547978971211.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547980104675.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547980144338.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547980233659.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981034775.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981088651.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981128506.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981162405.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981677784.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547981823867.png">
<meta property="og:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547986236848.png">
<meta property="og:updated_time" content="2019-01-26T12:22:26.764Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="苏·凌">
<meta name="twitter:description" content="5.实战内容【动态系统】终于到了本部分结尾，从开始写这部分内容到现在花了好久时间，几乎每天都不做别的事情，不知道写的内容有没有问题，有没有通俗易懂，不过反正我也是小白，有问题还需要请读者反馈,谢谢！ 实战内容来做什么呢？我们就来实现一个简单的朋友圈的功能。 当然对于这部分内容，我们仅仅实现发动态，改动态，删动态，查看动态这四个功能，其他的点赞，评论的功能其实也可以做，但是跨度太大，怕一时不能接受，">
<meta name="twitter:image" content="https://surine.cn/SpringBoot/2.快速入门/assets/1547949436448.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://surine.cn/SpringBoot/2.快速入门/5.实战内容.html">





  <title> | 苏·凌</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">苏·凌</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">风月都好看，爱恨都浪漫。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-springboot学习笔记">
          <a href="/SpringBoot/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            SpringBoot学习笔记
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-图片">
          <a href="/photo" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            图片
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

	<h1 class="post-title" itemprop="name headline"></h1>



</header>

      
      
      
      <div class="post-body">
        
        
          <h1 id="5-实战内容【动态系统】"><a href="#5-实战内容【动态系统】" class="headerlink" title="5.实战内容【动态系统】"></a>5.实战内容【动态系统】</h1><p>终于到了本部分结尾，从开始写这部分内容到现在花了好久时间，几乎每天都不做别的事情，不知道写的内容有没有问题，有没有通俗易懂，不过反正我也是小白，有问题还需要请读者反馈,谢谢！</p>
<p>实战内容来做什么呢？我们就来实现一个简单的朋友圈的功能。</p>
<p>当然对于这部分内容，我们仅仅实现发动态，改动态，删动态，查看动态这四个功能，其他的点赞，评论的功能其实也可以做，但是跨度太大，怕一时不能接受，您可以自行设计。</p>
<p>所有的源代码请参考 github,我会在文章结尾贴。  </p>
<p>国际惯例</p>
<h2 id="准备些什么东西？"><a href="#准备些什么东西？" class="headerlink" title="准备些什么东西？"></a>准备些什么东西？</h2><p>编码：<strong>Idea</strong>  </p>
<p>测试：<strong>PostMan</strong></p>
<p>数据库：<strong>Mysql及Mysql管理工具</strong></p>
<h2 id="1-需求及数据表设计"><a href="#1-需求及数据表设计" class="headerlink" title="1.需求及数据表设计"></a>1.需求及数据表设计</h2><p>对于动态，简化一下过程，设定只允许发文字动态，不允许有图片</p>
<p>那么对于一条动态，我们应该有以下几个字段</p>
<table>
<thead>
<tr>
<th>主键</th>
<th>动态内容</th>
<th>发送者ID</th>
<th>点赞数</th>
<th>评论数</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>text</td>
<td>user_id</td>
<td>love_num</td>
<td>review_num</td>
</tr>
</tbody>
</table>
<p>一共5个字段，我们不光有动态内容，也要有一个user_id来标识是谁发的，另外点赞数和评论数都是动态必有的属性。</p>
<p>我们先建立该表，详见下表</p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>类型</th>
<th>排序规则</th>
<th>注释</th>
<th>其他</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>int4</td>
<td></td>
<td>自增长主键</td>
<td>不为空</td>
</tr>
<tr>
<td>text</td>
<td>varchar100</td>
<td>utf8mb4_general_ci</td>
<td>动态内容</td>
<td>无默认值，不为空</td>
</tr>
<tr>
<td>user_id</td>
<td>int4</td>
<td></td>
<td>发送者id</td>
<td>无默认值，不为空</td>
</tr>
<tr>
<td>love_num</td>
<td>int4</td>
<td></td>
<td>点赞数</td>
<td>默认值为0</td>
</tr>
<tr>
<td>review_num</td>
<td>int4</td>
<td></td>
<td>评论数</td>
<td>默认值为0</td>
</tr>
</tbody>
</table>
<p>数据表就算设计完成了，下面我们新建一个项目。</p>
<h2 id="2-新建项目"><a href="#2-新建项目" class="headerlink" title="2. 新建项目"></a>2. 新建项目</h2><p>新建一个项目，然后在目录下建立如下文件。</p>
<p><img src="/SpringBoot/2.快速入门/assets/1547949436448.png" alt="1547949436448"></p>
<p>可以看到，我们建立了几个包，Controller，Entities，Mapper，Service，这里你没见过的就是Service，这里是为了逻辑分而建立的，我们把Controller里的逻辑移到Service里面写的，一会就可以看到这样写的好处。</p>
<p>然后分别在包下添加对应文件。</p>
<p>接下来我们导入mysql和mybatis的依赖，前面提到过就不再啰嗦了。</p>
<p>同时我们填入相应的数据库属性，如果还不明白的话，请参考数据库请求一节。</p>
<p>唯一想说的是，注意一下不要原模原样复制属性值，因为你的包名很可能不一样了。</p>
<p>我在综合提一下需要你提前配置好的东西：</p>
<ul>
<li>持久化依赖</li>
<li>数据库属性配置</li>
<li>Application中的Mapper映射。</li>
</ul>
<p>配置好了，你可以写一个HelloWorld接口测试一下。具体参考之前的，注意不要忘记Controller里的注解。</p>
<p>可以通过，我们就开始写接口。</p>
<h2 id="3-实体类"><a href="#3-实体类" class="headerlink" title="3. 实体类"></a>3. 实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.surine.moment_demo.Entities;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MomentEntity</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> userId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> loveNum;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> reviewNum;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MomentEntity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MomentEntity</span><span class="params">(<span class="keyword">int</span> id, String text, <span class="keyword">int</span> userId, <span class="keyword">long</span> loveNum, <span class="keyword">long</span> reviewNum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.text = text;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">        <span class="keyword">this</span>.loveNum = loveNum;</span><br><span class="line">        <span class="keyword">this</span>.reviewNum = reviewNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getText</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> text;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setText</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.text = text;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserId</span><span class="params">(<span class="keyword">int</span> userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getLoveNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> loveNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLoveNum</span><span class="params">(<span class="keyword">long</span> loveNum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loveNum = loveNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getReviewNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> reviewNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReviewNum</span><span class="params">(<span class="keyword">long</span> reviewNum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.reviewNum = reviewNum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实体类里有几个字段，分别对应了前面我们分析的数据表的内容，这里我们写了一个空构造，和一个完整的构造方法，toString方法可以自行添加，方便测试，这里我就不写了。</p>
<p>另外这里有一个小技巧</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.surine.moment_demo.Entities;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JsonUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> jCode;   <span class="comment">//状态码</span></span><br><span class="line">    <span class="keyword">private</span> String jMsg;  <span class="comment">//状态信息</span></span><br><span class="line">    <span class="keyword">private</span> Object jData;   <span class="comment">//携带的数据</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JsonUtil</span><span class="params">(<span class="keyword">int</span> jCode, String jMsg, Object jData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jCode = jCode;</span><br><span class="line">        <span class="keyword">this</span>.jMsg = jMsg;</span><br><span class="line">        <span class="keyword">this</span>.jData = jData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOk</span><span class="params">(Object data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jCode = <span class="number">2000</span>;</span><br><span class="line">        <span class="keyword">this</span>.jMsg = <span class="string">"操作成功"</span>;</span><br><span class="line">        <span class="keyword">this</span>.jData = data;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFail</span><span class="params">(Object data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jCode = <span class="number">4000</span>;</span><br><span class="line">        <span class="keyword">this</span>.jMsg = <span class="string">"操作失败"</span>;</span><br><span class="line">        <span class="keyword">this</span>.jData = data;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JsonUtil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getjCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setjCode</span><span class="params">(<span class="keyword">int</span> jCode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jCode = jCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getjMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jMsg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setjMsg</span><span class="params">(String jMsg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jMsg = jMsg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getjData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setjData</span><span class="params">(Object jData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.jData = jData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以继续写这样一个实体类，用于封装返回前端的Json内容，可以一次性携带请求状态，状态信息和数据等内容，当然你可以随意封装，写几个静态方法方便调用，下面我们可以看到具体的使用场景</p>
<h2 id="4-发送动态接口"><a href="#4-发送动态接口" class="headerlink" title="4.发送动态接口"></a>4.发送动态接口</h2><blockquote>
<p>注意写完一部分内容看效果要重启工程哦。</p>
</blockquote>
<p>从Mapper入手。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MomentMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送动态</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 操作状态</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"INSERT INTO moment(text,user_id) VALUES(#&#123;text&#125;, #&#123;userId&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(MomentEntity momentEntity)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>相信你已经很熟悉了，这边是插入一条内容，但是love_num,review_num是我们用于标识点赞数和评论数的，结合我们实际情况，我们不能发送动态的时候就传入。</p>
<p>再看Controller。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/moment"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MomentController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MomentService momentService;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> text 文本内容</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uid 发送者用户id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/sendMoment"</span>,method = RequestMethod.POST)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">sendMoment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            @RequestParam(value = <span class="string">"text"</span>)</span> String text,</span></span><br><span class="line"><span class="function">            @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid</span></span><br><span class="line"><span class="function">    )</span>&#123;</span><br><span class="line">       MomentEntity momentEntity = <span class="keyword">new</span> MomentEntity();</span><br><span class="line">       momentEntity.setText(text);</span><br><span class="line">       momentEntity.setUserId(uid);</span><br><span class="line">       <span class="keyword">return</span> momentService.sendMoment(momentEntity);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>内容貌似有点多，但是重复的内容还是不少。</p>
<p><strong>@RequestMapping(“/moment”)</strong>的加入，给本Controller也添加了访问路径了，相当于加了一个目录,我们可以通过多级路径来访问它</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost:<span class="number">8080</span>/moment/sendMoment</span><br></pre></td></tr></table></figure>
<p>下面是自动注入部分，之前我们一直直接注入Mapper，现在我们规范了写法，需要注入Service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"> <span class="keyword">private</span> MomentService momentService;</span><br></pre></td></tr></table></figure>
<p>其他的就没什么了，POST接受参数，并组装成对象，然后调用了service的sendMoment方法，就可以把数据发送到service里，那我们看看service都做了什么。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MomentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 注入Mapper，并且新建立一个JsonUtil对象，用于返回json封装</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MomentMapper momentMapper;</span><br><span class="line">    JsonUtil json = <span class="keyword">new</span> JsonUtil();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">sendMoment</span><span class="params">(MomentEntity momentEntity)</span></span>&#123;</span><br><span class="line">        <span class="comment">//检测参数是否为空，参数空的话，就提示前台，我们一会看效果</span></span><br><span class="line">        <span class="keyword">if</span>(momentEntity == <span class="keyword">null</span> || momentEntity.getText().isEmpty())&#123;</span><br><span class="line">            json.setEmptyParam(<span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> json;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//正式插入，调用momentMapper的insert方法</span></span><br><span class="line">        <span class="keyword">int</span> status = momentMapper.insert(momentEntity);</span><br><span class="line">        <span class="comment">//插入状态</span></span><br><span class="line">        <span class="keyword">if</span>(status &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">            json.setOk(<span class="keyword">null</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            json.setFail(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//返回数据</span></span><br><span class="line">        <span class="keyword">return</span> json;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注释写的已经很详细了，这里我们在service里面注入了mapper，并且封装了jsonUtil用于传递数据，接下来的逻辑就是动态内容判空（即不允许发送空白动态，如果是空白的，就返回提示），调用了插入方法之后，会有返回状态，以前都提过。</p>
<p>这样，我们就联通起来了。</p>
<p>我们看测试环境</p>
<blockquote>
<p>测试内容：localhost:8080/moment/sendMoment</p>
<p>text = 撑死了，uid = 4</p>
<p>测试结果 如下(数据库里最后一条)</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547978763297.png" alt="1547978763297"></p>
<p><img src="/SpringBoot/2.快速入门/assets/1547978894632.png" alt="1547978894632"></p>
<blockquote>
<p>测试内容：localhost:8080/moment/sendMoment</p>
<p>text = “”    uid = 4</p>
<p>测试结果如下，可以看到参数为空的提示</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547978971211.png" alt="1547978971211"></p>
<h2 id="5-删除动态"><a href="#5-删除动态" class="headerlink" title="5.删除动态"></a>5.删除动态</h2><p>下面我们实现按照id来删除动态。</p>
<p>Mapper内添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除动态</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 操作状态</span></span><br><span class="line"><span class="comment">     * 删除数据库内id = ？ and user_id = ? 的数据</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">"DELETE from moment where id = #&#123;id&#125; AND user_id = #&#123;userId&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(MomentEntity momentEntity)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Controller内添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 删除动态</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id 动态id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> uid 发送者用户id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="meta">@RequestMapping</span>(value = <span class="string">"/deleteMoment"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">deleteMoment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">           @RequestParam(value = <span class="string">"id"</span>)</span> <span class="keyword">int</span> id,</span></span><br><span class="line"><span class="function">           @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid</span></span><br><span class="line"><span class="function">   )</span>&#123;</span><br><span class="line">       MomentEntity momentEntity = <span class="keyword">new</span> MomentEntity();</span><br><span class="line">       momentEntity.setId(id);</span><br><span class="line">       momentEntity.setUserId(uid);</span><br><span class="line">       <span class="keyword">return</span> momentService.deleteMoment(momentEntity);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>与之前类似，不解释了，get传入id和uid</p>
<p>Service 内添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 删除数据</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">deleteMoment</span><span class="params">(MomentEntity momentEntity)</span></span>&#123;</span><br><span class="line">       <span class="comment">//检测参数是否为空</span></span><br><span class="line">       <span class="keyword">if</span>(momentEntity == <span class="keyword">null</span>)&#123;</span><br><span class="line">           json.setEmptyParam(<span class="keyword">null</span>);</span><br><span class="line">           <span class="keyword">return</span> json;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//正式删除</span></span><br><span class="line">       <span class="keyword">int</span> status = momentMapper.delete(momentEntity);</span><br><span class="line">       <span class="comment">//状态</span></span><br><span class="line">       <span class="keyword">if</span>(status &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">           json.setOk(<span class="keyword">null</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           json.setFail(<span class="keyword">null</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> json;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>测试内容：</p>
<blockquote>
<p>localhost:8080/moment/deleteMoment?id=2&amp;uid=1</p>
<p>返回结果如下，数据库如下</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547980104675.png" alt="1547980104675"></p>
<p><img src="/SpringBoot/2.快速入门/assets/1547980144338.png" alt="1547980144338"></p>
<p>我们可以对比之前的数据内容，id=2 ，uid = 1 的内容被我们删除了。</p>
<p>我们再来看看没有此条数据是什么情况：</p>
<blockquote>
<p>localhost:8080/moment/deleteMoment?id=4&amp;uid=1</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547980233659.png" alt="1547980233659"></p>
<p>我们在实际开发中，所考虑的不能是这么简单，还需要用户验证之类的，但是至少要保证，要删除的id 和uid对应能找到这么一条数据，否则就出问题了（但几乎是没啥问题，以防万一而已）</p>
<h2 id="6-修改动态"><a href="#6-修改动态" class="headerlink" title="6.修改动态"></a>6.修改动态</h2><p>我们按id，uid来匹配动态，并且传入修改的内容。</p>
<p>Mapper内添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新动态</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 操作状态</span></span><br><span class="line"><span class="comment">     * 更新id = ？and uid = ？的数据的text内容</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"UPDATE moment SET text=#&#123;text&#125; where id = #&#123;id&#125; AND user_id = #&#123;userId&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(MomentEntity momentEntity)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Controller内添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 更新动态</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> id 动态id</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> uid 发送者用户id</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> text 动态新内容</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">   * */</span></span><br><span class="line">  <span class="meta">@RequestMapping</span>(value = <span class="string">"/updateMoment"</span>,method = RequestMethod.POST)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">updateMoment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">          @RequestParam(value = <span class="string">"id"</span>)</span> <span class="keyword">int</span> id,</span></span><br><span class="line"><span class="function">          @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid,</span></span><br><span class="line"><span class="function">          @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"text"</span>)</span> String text</span></span><br><span class="line"><span class="function">  )</span>&#123;</span><br><span class="line">      MomentEntity momentEntity = <span class="keyword">new</span> MomentEntity();</span><br><span class="line">      momentEntity.setId(id);</span><br><span class="line">      momentEntity.setUserId(uid);</span><br><span class="line">      momentEntity.setText(text);</span><br><span class="line">      <span class="keyword">return</span> momentService.updateMoment(momentEntity);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>Service内添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">updateMoment</span><span class="params">(MomentEntity momentEntity)</span></span>&#123;</span><br><span class="line">        <span class="comment">//检测参数是否为空</span></span><br><span class="line">        <span class="keyword">if</span>(momentEntity == <span class="keyword">null</span> || momentEntity.getText().isEmpty())&#123;</span><br><span class="line">            json.setEmptyParam(<span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span> json;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//正式更新</span></span><br><span class="line">        <span class="keyword">int</span> status = momentMapper.update(momentEntity);</span><br><span class="line">        <span class="comment">//状态</span></span><br><span class="line">        <span class="keyword">if</span>(status &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">            json.setOk(<span class="keyword">null</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            json.setFail(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> json;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>测试内容：</p>
<blockquote>
<p>localhost:8080/moment/updateMoment</p>
<p>id = 6 uid =4  text = 我没吃饱怎么办</p>
<p>操作结果与数据库如下</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547981034775.png" alt="1547981034775"></p>
<p><img src="/SpringBoot/2.快速入门/assets/1547981088651.png" alt="1547981088651"></p>
<p>测试内容2</p>
<p><img src="/SpringBoot/2.快速入门/assets/1547981128506.png" alt="1547981128506"></p>
<p>测试内容3</p>
<p><img src="/SpringBoot/2.快速入门/assets/1547981162405.png" alt="1547981162405"></p>
<p>我很想解释一波，但是并木有什么可以解释的。</p>
<p>下面我们就来实现最后一个吧—–查询</p>
<h2 id="7-查询"><a href="#7-查询" class="headerlink" title="7.查询"></a>7.查询</h2><p>国际惯例 按id查询，和全列表查询</p>
<p>按id查询Mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询动态</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">     * 查询id = ？ and uid = ？ 的所有动态</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT * FROM moment where id = #&#123;id&#125; AND user_id = #&#123;userId&#125;"</span>)</span><br><span class="line">    <span class="function">MomentEntity <span class="title">selectOne</span><span class="params">(MomentEntity momentEntity)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Controller添加：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 按照id获取动态</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id 动态id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> uid 发送者用户id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="meta">@RequestMapping</span>(value = <span class="string">"/getOneMoment"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">getOneMoment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">           @RequestParam(value = <span class="string">"id"</span>)</span> <span class="keyword">int</span> id,</span></span><br><span class="line"><span class="function">           @<span class="title">RequestParam</span><span class="params">(value = <span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid</span></span><br><span class="line"><span class="function">   )</span>&#123;</span><br><span class="line">       MomentEntity momentEntity = <span class="keyword">new</span> MomentEntity();</span><br><span class="line">       momentEntity.setId(id);</span><br><span class="line">       momentEntity.setUserId(uid);</span><br><span class="line">       <span class="keyword">return</span> momentService.getOneMoment(momentEntity);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>Service如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 查询单条数据</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> momentEntity 动态实体</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">getOneMoment</span><span class="params">(MomentEntity momentEntity)</span></span>&#123;</span><br><span class="line">       <span class="comment">//检测参数是否为空</span></span><br><span class="line">       <span class="keyword">if</span>(momentEntity == <span class="keyword">null</span>)&#123;</span><br><span class="line">           json.setEmptyParam(<span class="keyword">null</span>);</span><br><span class="line">           <span class="keyword">return</span> json;</span><br><span class="line">       &#125;</span><br><span class="line">       MomentEntity seletMoment= momentMapper.selectOne(momentEntity);</span><br><span class="line">       <span class="comment">//状态</span></span><br><span class="line">       <span class="keyword">if</span>(seletMoment != <span class="keyword">null</span>)&#123;</span><br><span class="line">           json.setOk(seletMoment);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           json.setFail(<span class="keyword">null</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> json;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>这里唯一的不同 就是查询到数据，会把数据返回给前端。    </p>
<p>测试结果：</p>
<blockquote>
<p>localhost:8080/moment/getOneMoment?id = 5 &amp; uid = 3</p>
<p>测试结果如下，返回数据库相应数据，这里截图中是post方法，我的接口写的是get方法，其实不要被它迷惑了，postman的强大甚至可以给你自行改post为get ，哈哈哈哈…… 都一样，喜欢什么用什么即可。</p>
</blockquote>
<p><img src="/SpringBoot/2.快速入门/assets/1547981677784.png" alt="1547981677784"></p>
<p>另一种结果：</p>
<p><img src="/SpringBoot/2.快速入门/assets/1547981823867.png" alt="1547981823867"></p>
<p>这样你就实现了，按照id来查询动态的功能。</p>
<p>查询所有数据写法如下</p>
<p>Mapper:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 查询所有动态</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="meta">@Select</span>(<span class="string">"SELECT * FROM moment"</span>)</span><br><span class="line">   <span class="function">List&lt;MomentEntity&gt; <span class="title">selectAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>Controller:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 获取动态列表</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="meta">@RequestMapping</span>(value = <span class="string">"/getMoments"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">getMoments</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> momentService.getMoments();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>Service:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 查询所有数据</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> JsonUtil</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> JsonUtil <span class="title">getMoments</span><span class="params">()</span></span>&#123;</span><br><span class="line">       List&lt;MomentEntity&gt; momentEntityList = momentMapper.selectAll();</span><br><span class="line">       <span class="comment">//状态</span></span><br><span class="line">       <span class="keyword">if</span>(momentEntityList != <span class="keyword">null</span>)&#123;</span><br><span class="line">           json.setOk(momentEntityList);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           json.setFail(<span class="keyword">null</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> json;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>将momentEntityList传入返回对象中，即可返回给前端。</p>
<p>测试：请求地址：<strong>localhost:8080/moment/getMoments</strong>及测试结果</p>
<p><img src="/SpringBoot/2.快速入门/assets/1547986236848.png" alt="1547986236848"></p>
<p>额，这个实战写了好久好久……终于写完了。</p>
<p>不知道有没有什么错误，如果有问题或者疑问，还请小可爱们指出哦，核心源代码我会上传的。</p>
<h2 id="8-总结"><a href="#8-总结" class="headerlink" title="8.总结"></a>8.总结</h2><p>可能你做完这个觉得还是不爽，没有看到界面，只看到一堆乱七八糟的数据符号，根本就没有微信朋友圈的效果，不过我可以明确的告诉你，做APP后端，看到这些数据就已经OK了。</p>
<p>当然这些东西仅限于简单数据，还有复杂的数据参数传递之类的我会在后边再提。</p>
<p>学会这些就稍微放松一下吧！</p>
<p>或者自己尝试再实现一些小功能。</p>
<p>接下来我们会学习一些枯燥的东西。</p>
<p>本部分内容代码：<a href="https://github.com/Surine/SuSuBoot" target="_blank" rel="noopener">https://github.com/Surine/SuSuBoot</a></p>
<h1 id="点我回到目录"><a href="#点我回到目录" class="headerlink" title="点我回到目录"></a><a href="/SpringBoot/">点我回到目录</a></h1>
        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Surine</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/surine" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:surinx@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#5-实战内容【动态系统】"><span class="nav-number">1.</span> <span class="nav-text">5.实战内容【动态系统】</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#准备些什么东西？"><span class="nav-number">1.1.</span> <span class="nav-text">准备些什么东西？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-需求及数据表设计"><span class="nav-number">1.2.</span> <span class="nav-text">1.需求及数据表设计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-新建项目"><span class="nav-number">1.3.</span> <span class="nav-text">2. 新建项目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-实体类"><span class="nav-number">1.4.</span> <span class="nav-text">3. 实体类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-发送动态接口"><span class="nav-number">1.5.</span> <span class="nav-text">4.发送动态接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-删除动态"><span class="nav-number">1.6.</span> <span class="nav-text">5.删除动态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-修改动态"><span class="nav-number">1.7.</span> <span class="nav-text">6.修改动态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-查询"><span class="nav-number">1.8.</span> <span class="nav-text">7.查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-总结"><span class="nav-number">1.9.</span> <span class="nav-text">8.总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#点我回到目录"><span class="nav-number">2.</span> <span class="nav-text">点我回到目录</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-github"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Surine</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
